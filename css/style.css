:root {
    --ink:        #1a1209;
    --parchment:  #fdf6e3;
    --parchment2: #f5ead0;
    --stone:      #9e8f79;
    --stone-lt:   #d4c9b4;
    --border:     #c9baa0;
    --accent:     #8b3a1e;
    --accent-lt:  #f0ddd6;
    --nom:  #1a3fcc;
    --voc:  #1a3fcc;
    --acc:  #1e7a35;
    --gen:  #666666;
    --dat:  #b06000;
    --vrb:  #b81414;
    --inf:  #6b1db8;
    --cco:  #c07800;
    --csu:  #007a6e;
    --radius: 6px;
    --font-latin: 'Cormorant Garamond', Georgia, serif;
    --font-ui:    'DM Sans', sans-serif;
}
*, *::before, *::after { box-sizing:border-box; margin:0; padding:0; }
body { font-family:var(--font-ui); background:var(--parchment); color:var(--ink); min-height:100vh; display:flex; flex-direction:column; }

/* ── Header ── */
header { background:var(--ink); color:var(--parchment); padding:14px 28px; display:flex; align-items:baseline; gap:14px; border-bottom:3px solid var(--accent); flex-shrink:0; }
header h1 { font-family:var(--font-latin); font-weight:600; font-size:1.5rem; letter-spacing:.04em; }
header p  { font-size:.74rem; color:var(--stone-lt); font-weight:300; }

/* ── Dépôt ── */
#deposit-section { padding:18px 28px 14px; border-bottom:1px solid var(--border); background:var(--parchment2); flex-shrink:0; }
#deposit-section h2 { font-family:var(--font-latin); font-size:.9rem; color:var(--stone); font-weight:400; text-transform:uppercase; letter-spacing:.07em; margin-bottom:6px; }
#raw-latin-input { width:100%; min-height:72px; font-family:var(--font-latin); font-size:1.05rem; line-height:1.7; background:#fff; border:1px solid var(--border); border-radius:var(--radius); padding:8px 12px; color:var(--ink); resize:vertical; }
#raw-latin-input:focus { outline:none; border-color:var(--accent); }
#raw-latin-input.hidden { display:none; }
.dep-btns { margin-top:7px; display:flex; gap:8px; }
#btn-deposit { padding:7px 20px; background:var(--accent); color:#fff; border:none; border-radius:var(--radius); font-family:var(--font-ui); font-size:.84rem; font-weight:500; cursor:pointer; }
#btn-deposit:hover { background:#6e2e17; }
#btn-reset { padding:7px 14px; background:transparent; color:var(--stone); border:1px solid var(--border); border-radius:var(--radius); font-size:.8rem; cursor:pointer; display:none; }
#btn-reset.visible { display:inline-block; }

/* ── Zone principale ── */
#main-area { display:none; flex:1; overflow:hidden; grid-template-columns:1fr 1fr 1fr; }
#main-area.visible { display:grid; }
.column { padding:18px 20px; overflow-y:auto; border-right:1px solid var(--border); display:flex; flex-direction:column; gap:0; }
.column:last-child { border-right:none; }
.col-title { font-family:var(--font-latin); font-size:.72rem; color:var(--stone); text-transform:uppercase; letter-spacing:.1em; margin-bottom:12px; display:flex; align-items:center; gap:8px; flex-shrink:0; }
.col-title::after { content:''; flex:1; height:1px; background:var(--border); }

/* ─── COL 1 : texte intégral ─── */
#full-latin-display { font-family:var(--font-latin); font-size:1.12rem; line-height:2.1; flex:1; }
.full-word { cursor:pointer; border-bottom:1px dotted transparent; transition:border-color .15s, color .15s; }
.full-word:hover  { border-bottom-color:var(--accent); color:var(--accent); }
.full-word.active { border-bottom-color:var(--accent); color:var(--accent); font-weight:600; }

/* ─── COL 2 : tokens ─── */
#tokenized-display { flex:1; }
.token-sentence { display:block; margin-bottom:10px; padding-bottom:8px; border-bottom:1px dashed var(--stone-lt); }
.token-sentence:last-child { border-bottom:none; }
.latin-word { display:inline-block; font-family:var(--font-latin); font-size:1.08rem; padding:2px 6px; margin:3px 2px; border:1px solid var(--stone-lt); background:#fff; border-radius:4px; cursor:pointer; line-height:1.5; transition:background .15s, border-color .15s; user-select:none; }
.latin-word:hover    { background:var(--accent-lt); border-color:var(--accent); }
.latin-word.selected { background:var(--accent-lt); border-color:var(--accent); font-weight:600; }

/* Couleurs grammaticales */
.color-nominatif { color:var(--nom); border-color:var(--nom); }
.color-vocatif   { color:var(--voc); border-color:var(--voc); }
.color-accusatif { color:var(--acc); border-color:var(--acc); }
.color-genitif   { color:var(--gen); border-color:var(--gen); }
.color-dat-abl   { color:var(--dat); border-color:var(--dat); }
.color-verbe     { color:var(--vrb); border-color:var(--vrb); }
.color-infinitif { color:var(--inf); border-color:var(--inf); font-style:italic; }
.color-coord  { color:var(--cco); border:2px solid var(--cco); border-radius:12px; padding:1px 8px; }
.color-subord { color:var(--csu); border:2px solid var(--csu); border-radius:2px;  padding:1px 8px; }

/* ─── Zone de réordonnancement (dans col 2) ─── */
#reorder-section { flex-shrink:0; margin-top:14px; border-top:1px solid var(--border); padding-top:12px; }
.reorder-section-title { font-family:var(--font-latin); font-size:.7rem; color:var(--stone); text-transform:uppercase; letter-spacing:.09em; margin-bottom:8px; }
.reorder-actions { display:flex; gap:5px; flex-wrap:wrap; margin-bottom:8px; }
.btn-reorder { padding:5px 10px; font-size:.73rem; border-radius:var(--radius); cursor:pointer; border:1px solid var(--border); background:#fff; font-family:var(--font-ui); transition:all .15s; }
.btn-reorder:hover { background:var(--parchment2); }
.btn-reorder.primary { background:var(--accent); color:#fff; border-color:var(--accent); }
.btn-reorder.primary:hover { background:#6e2e17; }
.btn-reorder.danger { border-color:#e0aaaa; color:#9b2020; }
.btn-reorder.danger:hover { background:#fdf0f0; }
#reorder-zone { min-height:80px; border:2px dashed var(--border); border-radius:var(--radius); padding:8px; display:flex; flex-wrap:wrap; align-content:flex-start; gap:3px; transition:border-color .2s, background .2s; position:relative; }
#reorder-zone.drag-over { border-color:var(--accent); background:var(--accent-lt); }
.reorder-empty-hint { color:var(--stone-lt); font-size:.78rem; font-style:italic; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; pointer-events:none; user-select:none; }
.reorder-break { width:100%; height:0; border-top:1px dashed var(--stone-lt); margin:3px 0; flex-shrink:0; }
.reorder-token { display:inline-flex; align-items:center; gap:3px; font-family:var(--font-latin); font-size:1rem; padding:2px 6px 2px 3px; margin:2px; border:1px solid var(--stone-lt); background:#fff; border-radius:4px; cursor:grab; line-height:1.5; user-select:none; transition:box-shadow .15s, opacity .15s; }
.reorder-token:active { cursor:grabbing; }
.reorder-token.dragging { opacity:.4; }
.reorder-token .drag-handle { font-size:.65rem; color:var(--stone-lt); }
.reorder-token:hover { box-shadow:0 2px 6px rgba(0,0,0,.12); }
.reorder-token.color-nominatif { color:var(--nom); border-color:var(--nom); }
.reorder-token.color-vocatif   { color:var(--voc); border-color:var(--voc); }
.reorder-token.color-accusatif { color:var(--acc); border-color:var(--acc); }
.reorder-token.color-genitif   { color:var(--gen); border-color:var(--gen); }
.reorder-token.color-dat-abl   { color:var(--dat); border-color:var(--dat); }
.reorder-token.color-verbe     { color:var(--vrb); border-color:var(--vrb); }
.reorder-token.color-infinitif { color:var(--inf); border-color:var(--inf); font-style:italic; }
.reorder-token.color-coord  { color:var(--cco); border:2px solid var(--cco); border-radius:12px; }
.reorder-token.color-subord { color:var(--csu); border:2px solid var(--csu); border-radius:2px; }

/* ─── COL 3 : traduction libre ─── */
#col-translation { background:#fafaf7; }
#translation-hint { font-size:.75rem; color:var(--stone); font-style:italic; margin-bottom:10px; line-height:1.5; flex-shrink:0; }
#translation-area {
    flex:1; min-height:200px;
    font-family:var(--font-latin); font-size:1.1rem; line-height:1.8;
    background:#fff; border:1px solid var(--border); border-radius:var(--radius);
    padding:12px 14px; color:var(--ink); resize:none; width:100%;
    outline:none;
}
#translation-area:focus { border-color:var(--accent); }
.translation-actions { display:flex; gap:6px; margin-top:8px; flex-shrink:0; }
.btn-trans { padding:5px 12px; font-size:.75rem; border-radius:var(--radius); cursor:pointer; border:1px solid var(--border); background:#fff; font-family:var(--font-ui); transition:all .15s; }
.btn-trans:hover { background:var(--parchment2); }
.btn-trans.danger { border-color:#e0aaaa; color:#9b2020; }
.btn-trans.danger:hover { background:#fdf0f0; }

/* ─── POPUP ─── */
.popup-overlay { display:none; position:fixed; inset:0; z-index:200; }
.popup-overlay.visible { display:block; }
.popup-box {
    position:absolute; background:#fff; border:1px solid var(--border);
    border-radius:var(--radius); box-shadow:0 8px 32px rgba(0,0,0,.2);
    padding:14px 16px; min-width:240px; max-width:320px; z-index:201;
}
.popup-word { font-family:var(--font-latin); font-size:1.1rem; font-weight:600; color:var(--accent); margin-bottom:10px; }
.popup-section-label { font-size:.68rem; color:var(--stone); text-transform:uppercase; letter-spacing:.08em; margin-bottom:5px; margin-top:10px; font-weight:500; }
.popup-section-label:first-of-type { margin-top:0; }

/* grille catégories */
.popup-case-grid { display:flex; flex-wrap:wrap; gap:4px; margin-bottom:2px; }
.popup-case-btn { padding:3px 9px; border-radius:20px; border:1px solid var(--border); background:#fff; font-family:var(--font-ui); font-size:.72rem; cursor:pointer; transition:all .15s; color:var(--ink); }
.popup-case-btn:hover { background:var(--parchment2); }
.popup-case-btn[data-case="nominatif"].active  { background:var(--nom); color:#fff; border-color:var(--nom); }
.popup-case-btn[data-case="vocatif"].active    { background:var(--voc); color:#fff; border-color:var(--voc); }
.popup-case-btn[data-case="accusatif"].active  { background:var(--acc); color:#fff; border-color:var(--acc); }
.popup-case-btn[data-case="genitif"].active    { background:var(--gen); color:#fff; border-color:var(--gen); }
.popup-case-btn[data-case="dat-abl"].active    { background:var(--dat); color:#fff; border-color:var(--dat); }
.popup-case-btn[data-case="verbe"].active      { background:var(--vrb); color:#fff; border-color:var(--vrb); }
.popup-case-btn[data-case="infinitif"].active  { background:var(--inf); color:#fff; border-color:var(--inf); font-style:italic; }
.popup-case-btn[data-case="coord"].active      { background:var(--cco); color:#fff; border-color:var(--cco); }
.popup-case-btn[data-case="subord"].active     { background:var(--csu); color:#fff; border-color:var(--csu); }

/* liens dans le popup */
.popup-links { display:flex; flex-wrap:wrap; gap:6px; margin-top:4px; }
.popup-link { display:inline-block; padding:3px 10px; border-radius:3px; text-decoration:none; font-size:.73rem; font-weight:500; transition:opacity .15s; }
.popup-link:hover { opacity:.8; }
.popup-link-gaffiot { background:var(--accent); color:#fff; }
.popup-link-perseus { background:#1a3a5c; color:#fff; }

.popup-actions { display:flex; gap:6px; margin-top:10px; border-top:1px solid var(--border); padding-top:8px; }
.popup-btn-sm { padding:4px 10px; font-size:.72rem; border-radius:4px; cursor:pointer; border:1px solid var(--border); background:#fff; transition:all .15s; }
.popup-btn-sm:hover { background:var(--parchment2); }
.popup-btn-sm.danger { border-color:#e0aaaa; color:#9b2020; }
.popup-btn-sm.danger:hover { background:#fdf0f0; }
.popup-close { margin-left:auto; }

/* Nouveau style pour les résultats d'analyse */
#french-analysis-result {
    margin-top: 12px;
    display: none;
    background: #fff;
    padding: 12px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.85rem;
    line-height: 1.6;
}
